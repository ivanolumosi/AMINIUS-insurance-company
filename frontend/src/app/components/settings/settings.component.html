<div class="settings-container">
    <app-navbar>
    </app-navbar>
  <!-- Header -->
  <div class="settings-header">
    <div class="header-content">
      <div class="header-left">
        <i class="fas fa-cog"></i>
        <h1>Settings</h1>
      </div>
      <div class="header-right">
        <button class="btn-icon" (click)="exportData()" title="Export Settings">
          <i class="fas fa-download"></i>
        </button>
        <label class="btn-icon" title="Import Settings">
          <i class="fas fa-upload"></i>
          <input type="file" (change)="importData($event)" accept=".json" style="display: none;">
        </label>
      </div>
    </div>
  </div>

  <!-- Navigation Tabs -->
  <div class="settings-nav">
    <button 
      class="nav-tab" 
      [class.active]="activeTab === 'policies'"
      (click)="setActiveTab('policies')">
      <i class="fas fa-file-contract"></i>
      <span>Policy Catalog</span>
    </button>
    <button 
      class="nav-tab" 
      [class.active]="activeTab === 'reminders'"
      (click)="setActiveTab('reminders')">
      <i class="fas fa-bell"></i>
      <span>Reminders</span>
    </button>
    <button 
      class="nav-tab" 
      [class.active]="activeTab === 'notifications'"
      (click)="setActiveTab('notifications')">
      <i class="fas fa-envelope"></i>
      <span>Notifications</span>
    </button>
    <button 
      class="nav-tab" 
      [class.active]="activeTab === 'profile'"
      (click)="setActiveTab('profile')">
      <i class="fas fa-user"></i>
      <span>Profile</span>
    </button>
    <button 
      class="nav-tab" 
      [class.active]="activeTab === 'general'"
      (click)="setActiveTab('general')">
      <i class="fas fa-sliders-h"></i>
      <span>General</span>
    </button>
  </div>

  <!-- Settings Content -->
  <div class="settings-content">

    <!-- Policy Catalog Tab -->
    <div class="tab-content" [class.active]="activeTab === 'policies'">
      <div class="section-header">
        <h2><i class="fas fa-file-contract"></i> Policy Catalog Management</h2>
        <button class="btn-primary" (click)="showAddPolicyForm = true" *ngIf="!showAddPolicyForm">
          <i class="fas fa-plus"></i> Add Policy
        </button>
      </div>

      <!-- Add Policy Form -->
      <div class="add-form-card" *ngIf="showAddPolicyForm">
        <h3><i class="fas fa-plus-circle"></i> Add New Policy</h3>
        <div class="form-grid">
          <div class="form-group">
            <label>Policy Name</label>
            <input type="text" [(ngModel)]="newPolicy.name" placeholder="Enter policy name">
          </div>
          <div class="form-group">
            <label>Policy Type</label>
            <select [(ngModel)]="newPolicy.type">
              <option value="">Select type</option>
              <option *ngFor="let type of policyTypes" [value]="type">{{type}}</option>
            </select>
          </div>
          <div class="form-group">
            <label>Insurance Company</label>
            <select [(ngModel)]="newPolicy.companyName">
              <option value="">Select company</option>
              <option *ngFor="let company of insuranceCompanies" [value]="company">{{company}}</option>
            </select>
          </div>
          <div class="form-group full-width">
            <label>Notes (Optional)</label>
            <textarea [(ngModel)]="newPolicy.notes" placeholder="Additional notes about this policy"></textarea>
          </div>
        </div>
        <div class="form-actions">
          <button class="btn-secondary" (click)="resetPolicyForm()">
            <i class="fas fa-times"></i> Cancel
          </button>
          <button class="btn-primary" (click)="addPolicy()">
            <i class="fas fa-save"></i> Save Policy
          </button>
        </div>
      </div>

      <!-- Policy List -->
      <div class="policy-grid">
        <div class="policy-card" *ngFor="let policy of policyCatalog">
          <div class="policy-header">
            <h4>{{policy.name}}</h4>
            <div class="policy-actions">
              <button class="btn-icon" (click)="editPolicy(policy)" title="Edit Policy">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn-icon danger" (click)="deletePolicy(policy.id)" title="Delete Policy">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </div>
          <div class="policy-info">
            <div class="info-item">
              <i class="fas fa-tag"></i>
              <span>{{policy.type}}</span>
            </div>
            <div class="info-item">
              <i class="fas fa-building"></i>
              <span>{{policy.companyName}}</span>
            </div>
            <div class="info-item" *ngIf="policy.notes">
              <i class="fas fa-sticky-note"></i>
              <span>{{policy.notes}}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Edit Policy Modal -->
      <div class="modal-overlay" *ngIf="editingPolicy" (click)="editingPolicy = null">
        <div class="modal-content" (click)="$event.stopPropagation()">
          <h3><i class="fas fa-edit"></i> Edit Policy</h3>
          <div class="form-grid">
            <div class="form-group">
              <label>Policy Name</label>
              <input type="text" [(ngModel)]="editingPolicy.name">
            </div>
            <div class="form-group">
              <label>Policy Type</label>
              <select [(ngModel)]="editingPolicy.type">
                <option *ngFor="let type of policyTypes" [value]="type">{{type}}</option>
              </select>
            </div>
            <div class="form-group">
              <label>Insurance Company</label>
              <select [(ngModel)]="editingPolicy.companyName">
                <option *ngFor="let company of insuranceCompanies" [value]="company">{{company}}</option>
              </select>
            </div>
            <div class="form-group full-width">
              <label>Notes</label>
              <textarea [(ngModel)]="editingPolicy.notes"></textarea>
            </div>
          </div>
          <div class="modal-actions">
            <button class="btn-secondary" (click)="editingPolicy = null">Cancel</button>
            <button class="btn-primary" (click)="updatePolicy()">Update Policy</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Reminders Tab -->
    <div class="tab-content" [class.active]="activeTab === 'reminders'">
      <div class="section-header">
        <h2><i class="fas fa-bell"></i> Reminder Settings</h2>
      </div>

      <div class="reminder-settings">
        <div class="reminder-card" *ngFor="let reminder of reminderSettings">
          <div class="reminder-header">
            <div class="reminder-title">
              <i class="fas fa-bell"></i>
              <h4>{{reminder.type}} Reminders</h4>
            </div>
            <div class="toggle-switch">
              <input 
                type="checkbox" 
                [id]="'reminder-' + reminder.id"
                [checked]="reminder.enabled"
                (change)="toggleReminder(reminder.id)">
              <label [for]="'reminder-' + reminder.id"></label>
            </div>
          </div>
          
          <div class="reminder-config" *ngIf="reminder.enabled">
            <div class="config-row">
              <label>Days Before:</label>
              <select [(ngModel)]="reminder.daysBefore" (change)="updateReminderSetting(reminder)">
                <option value="0">Same Day</option>
                <option value="1">1 Day</option>
                <option value="3">3 Days</option>
                <option value="7">1 Week</option>
                <option value="30">1 Month</option>
              </select>
            </div>
            <div class="config-row">
              <label>Time:</label>
              <input 
                type="time" 
                [(ngModel)]="reminder.timeOfDay" 
                (change)="updateReminderSetting(reminder)">
            </div>
            <div class="config-row" *ngIf="reminder.type === 'Call'">
              <label>Repeat Daily:</label>
              <div class="toggle-switch small">
                <input 
                  type="checkbox" 
                  [id]="'repeat-' + reminder.id"
                  [(ngModel)]="reminder.repeatDaily"
                  (change)="updateReminderSetting(reminder)">
                <label [for]="'repeat-' + reminder.id"></label>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Notifications Tab -->
    <div class="tab-content" [class.active]="activeTab === 'notifications'">
      <div class="section-header">
        <h2><i class="fas fa-envelope"></i> Notification Preferences</h2>
      </div>

      <div class="notification-settings">
        <div class="notification-card">
          <h3><i class="fas fa-paper-plane"></i> Communication Channels</h3>
          
          <div class="setting-item">
            <div class="setting-info">
              <i class="fas fa-envelope"></i>
              <div>
                <h4>Email Notifications</h4>
                <p>Receive notifications via email</p>
              </div>
            </div>
            <div class="toggle-switch">
              <input 
                type="checkbox" 
                id="email-notifications"
                [(ngModel)]="notificationSettings.emailNotifications"
                (change)="updateNotificationSettings()">
              <label for="email-notifications"></label>
            </div>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <i class="fas fa-sms"></i>
              <div>
                <h4>SMS Notifications</h4>
                <p>Receive notifications via SMS</p>
              </div>
            </div>
            <div class="toggle-switch">
              <input 
                type="checkbox" 
                id="sms-notifications"
                [(ngModel)]="notificationSettings.smsNotifications"
                (change)="updateNotificationSettings()">
              <label for="sms-notifications"></label>
            </div>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <i class="fab fa-whatsapp"></i>
              <div>
                <h4>WhatsApp Notifications</h4>
                <p>Receive notifications via WhatsApp</p>
              </div>
            </div>
            <div class="toggle-switch">
              <input 
                type="checkbox" 
                id="whatsapp-notifications"
                [(ngModel)]="notificationSettings.whatsappNotifications"
                (change)="updateNotificationSettings()">
              <label for="whatsapp-notifications"></label>
            </div>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <i class="fas fa-mobile-alt"></i>
              <div>
                <h4>Push Notifications</h4>
                <p>Receive push notifications on device</p>
              </div>
            </div>
            <div class="toggle-switch">
              <input 
                type="checkbox" 
                id="push-notifications"
                [(ngModel)]="notificationSettings.pushNotifications"
                (change)="updateNotificationSettings()">
              <label for="push-notifications"></label>
            </div>
          </div>

          <div class="setting-item">
            <div class="setting-info">
              <i class="fas fa-volume-up"></i>
              <div>
                <h4>Sound Alerts</h4>
                <p>Play sound for notifications</p>
              </div>
            </div>
            <div class="toggle-switch">
              <input 
                type="checkbox" 
                id="sound-enabled"
                [(ngModel)]="notificationSettings.soundEnabled"
                (change)="updateNotificationSettings()">
              <label for="sound-enabled"></label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Profile Tab -->
    <div class="tab-content" [class.active]="activeTab === 'profile'">
      <div class="section-header">
        <h2><i class="fas fa-user"></i> Profile Information</h2>
        <button class="btn-primary" (click)="toggleProfileEdit()" *ngIf="!showProfileEdit">
          <i class="fas fa-edit"></i> Edit Profile
        </button>
      </div>

      <div class="profile-section">
        <div class="profile-avatar">
          <div class="avatar-circle">
            <i class="fas fa-user"></i>
          </div>
          <button class="btn-icon" *ngIf="showProfileEdit">
            <i class="fas fa-camera"></i>
          </button>
        </div>

        <div class="profile-form">
          <div class="form-grid" *ngIf="showProfileEdit; else viewProfile">
            <div class="form-group">
              <label>First Name</label>
              <input type="text" [(ngModel)]="userProfile.firstName">
            </div>
            <div class="form-group">
              <label>Last Name</label>
              <input type="text" [(ngModel)]="userProfile.lastName">
            </div>
            <div class="form-group">
              <label>Email</label>
              <input type="email" [(ngModel)]="userProfile.email">
            </div>
            <div class="form-group">
              <label>Phone Number</label>
              <input type="tel" [(ngModel)]="userProfile.phone">
            </div>
            <div class="form-group">
              <label>Company</label>
              <input type="text" [(ngModel)]="userProfile.company">
            </div>
            <div class="form-group">
              <label>License Number</label>
              <input type="text" [(ngModel)]="userProfile.licenseNumber">
            </div>
          </div>

          <ng-template #viewProfile>
            <div class="profile-info">
              <div class="info-row">
                <i class="fas fa-user"></i>
                <span class="label">Name:</span>
                <span class="value">{{userProfile.firstName}} {{userProfile.lastName}}</span>
              </div>
              <div class="info-row">
                <i class="fas fa-envelope"></i>
                <span class="label">Email:</span>
                <span class="value">{{userProfile.email}}</span>
              </div>
              <div class="info-row">
                <i class="fas fa-phone"></i>
                <span class="label">Phone:</span>
                <span class="value">{{userProfile.phone}}</span>
              </div>
              <div class="info-row">
                <i class="fas fa-building"></i>
                <span class="label">Company:</span>
                <span class="value">{{userProfile.company}}</span>
              </div>
              <div class="info-row">
                <i class="fas fa-id-card"></i>
                <span class="label">License:</span>
                <span class="value">{{userProfile.licenseNumber}}</span>
              </div>
            </div>
          </ng-template>

          <div class="form-actions" *ngIf="showProfileEdit">
            <button class="btn-secondary" (click)="showProfileEdit = false">
              <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn-primary" (click)="updateProfile()">
              <i class="fas fa-save"></i> Save Changes
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- General Tab -->
    <div class="tab-content" [class.active]="activeTab === 'general'">
      <div class="section-header">
        <h2><i class="fas fa-sliders-h"></i> General Settings</h2>
      </div>

      <div class="general-settings">
        <div class="setting-card">
          <h3><i class="fas fa-palette"></i> Appearance</h3>
          
          <div class="setting-item">
            <div class="setting-info">
              <i class="fas fa-moon"></i>
              <div>
                <h4>Dark Mode</h4>
                <p>Enable dark theme for better night viewing</p>
              </div>
            </div>
            <div class="toggle-switch">
              <input 
                type="checkbox" 
                id="dark-mode"
                [(ngModel)]="darkMode"
                (change)="toggleDarkMode()">
              <label for="dark-mode"></label>
            </div>
          </div>
        </div>

        <div class="setting-card">
          <h3><i class="fas fa-database"></i> Data Management</h3>
          
          <div class="data-actions">
            <button class="btn-secondary" (click)="exportData()">
              <i class="fas fa-download"></i>
              Export Settings
            </button>
            
            <label class="btn-secondary">
              <i class="fas fa-upload"></i>
              Import Settings
              <input type="file" (change)="importData($event)" accept=".json" style="display: none;">
            </label>
          </div>
          
          <div class="data-info">
            <p><i class="fas fa-info-circle"></i> Export your settings to backup or transfer to another device.</p>
          </div>
        </div>

        <div class="setting-card">
          <h3><i class="fas fa-info-circle"></i> About</h3>
          
          <div class="about-info">
            <div class="app-logo">
              <i class="fas fa-shield-alt"></i>
              <h4>Aminus</h4>
              <p>Trust, Care, Growth</p>
            </div>
            
            <div class="app-details">
              <p><strong>Version:</strong> 1.0.0</p>
              <p><strong>Build:</strong> 2025.01.001</p>
              <p><strong>Last Updated:</strong> January 2025</p>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
